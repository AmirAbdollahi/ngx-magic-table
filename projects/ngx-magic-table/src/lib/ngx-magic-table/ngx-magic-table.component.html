<div>
    <table class="table table-bordered table-striped table-bordered table-hover">
      <thead>
        <tr *ngFor="let cellRow of cells">
          <th *ngFor="let cell of cellRow" [id]="uid+'-'+cell.name+'-head'" [draggable]="cell.template.draggable" (drop)="drop(cell)"
            (dragover)="allowDrop($event)" (dragstart)="drag(cell)" [attr.colspan]="cell.colSpan" [attr.rowspan]="cell.rowSpan"
            (click)="sortToggle(cell)">
            <ng-template  [ngTemplateOutlet]="cell.template.header" [ngTemplateOutletContext]="{cell: cell, direction: (cell.name === sort) ? sortDirection : undefined}"></ng-template>
            <div ngbDropdown *ngIf="cell.template.filter" (click)="$event.stopPropagation()" class="dropdown float-right">
              <button ngbDropdownToggle type="button" [ngClass]="[cell.filters.length == 0 ? 'btn-default' : 'btn-warning']" class="btn " [id]="uid + '-' +cell.name + '-filter'" >
                <i class="fa fa-filter"></i>
              </button>
              <div ngbDropdownMenu [aria-labelledby]="uid + '-' +cell.name + '-filter'" class="dropdown-menu" (click)="$event.stopPropagation()">
                <div class="container">
                  <ng-template [ngTemplateOutlet]="cell.template.filter" [ngTemplateOutletContext]="{cell: cell, rows: rows}"></ng-template>
                </div>
              </div>
            </div>
          </th>
        </tr>
      </thead>
      <tbody *ngIf="paginated">
        <tr (click)="selectRow(row)" [ngClass]="[row === selectedRow ? selectedClass : '']" *ngFor="let row of rows | sort:{field: sort, direction: sortDirection, active: !customSort} | paginate: {
        itemsPerPage: perPage,
        currentPage: currentPage,
        totalItems: customPaginate ? totalCount : rows.length,
        id: uid }">
          <td *ngFor="let cell of lowerCells">
            <ng-template [ngTemplateOutlet]="cell.template.body" [ngTemplateOutletContext]="{row: row, cell: cell}"></ng-template>
          </td>
        </tr>
      </tbody>
      <tbody *ngIf="!paginated">
        <tr (click)="selectRow(row)" *ngFor="let row of rows">
          <td *ngFor="let cell of lowerCells">
            <ng-template [ngTemplateOutlet]="cell.template.body" [ngTemplateOutletContext]="{row: row, cell: cell}"></ng-template>
          </td>
        </tr>
      </tbody>
    </table>
    <div class="btn-group" *ngIf="paginated">
      <pagination-controls  (pageChange)="selectPage($event)" previousLabel="" nextLabel="" [id]="uid"></pagination-controls>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <div *ngIf="perPages.length" ngbDropdown class="dropdown">
        <select class="btn btn-secondary btn-sm dropdown-toggle" (change)="changePerPage($event.target.value)">
          <option *ngFor="let p of perPages" class="btn btn-sm btn-secondary">{{p}}</option>
        </select>
      </div>
    </div>
  </div>
  